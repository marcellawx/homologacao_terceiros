<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protótipo - Central de Contratos de Terceiros</title>
    <style>
        :root {
            --cor-primaria: #0072C6; --cor-sucesso: #28a745; --cor-perigo: #dc3545;
            --cor-aviso: #FFC107; --cor-info: #6f42c1; --cor-fundo: #F4F7FC;
            --cor-fundo-coluna: #E9ECEF; --cor-texto: #333; --cor-borda: #DEE2E6;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--cor-fundo); margin: 0; padding: 25px; color: var(--cor-texto); }
        h1, h2 { color: var(--cor-primaria); }
        h1 { text-align: center; margin-bottom: 20px; }

        /* --- NOTIFICAÇÃO --- */
        .notification-bar { background-color: var(--cor-aviso); color: #333; padding: 12px 20px; text-align: center; font-size: 16px; font-weight: bold; border-radius: 6px; margin-bottom: 20px; display: none; }
        .notification-bar a { color: var(--cor-primaria); text-decoration: underline; cursor: pointer; }

        /* --- NAVEGAÇÃO POR ABAS --- */
        .main-tabs { border-bottom: 2px solid var(--cor-borda); margin-bottom: 25px; text-align: center; }
        .tab-btn { background-color: transparent; border: none; padding: 15px 25px; font-size: 18px; cursor: pointer; color: #555; border-bottom: 4px solid transparent; }
        .tab-btn.active { color: var(--cor-primaria); border-bottom-color: var(--cor-primaria); font-weight: bold; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* --- CONTROLES (PESQUISA E FILTROS) --- */
        .controls-container { display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; }
        .controls-container input, .controls-container select { padding: 10px; border: 1px solid var(--cor-borda); border-radius: 5px; font-size: 16px; }
        .controls-container input[type="search"] { flex-grow: 1; }
        .controls-container label { display: flex; align-items: center; gap: 5px; font-size: 14px;} /* Estilo para label do input month */

        /* --- LAYOUT DO KANBAN --- */
        .kanban-board { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px; }
        .kanban-column { flex: 1; min-width: 320px; background-color: var(--cor-fundo-coluna); border-radius: 8px; padding: 15px; }
        .kanban-column h2 { font-size: 18px; margin: 0 0 15px 0; padding-bottom: 10px; border-bottom: 2px solid var(--cor-borda); display: flex; justify-content: space-between; align-items: center; }
        .task-count { background-color: #ced4da; color: #495057; border-radius: 12px; padding: 2px 10px; font-size: 14px; }

        /* --- ESTILO DOS CARDS (KANBAN e PÓS-HOMOLOGAÇÃO) --- */
        .card-base { background-color: #FFF; padding: 15px; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); margin-bottom: 15px; }
        .kanban-card { border-left: 5px solid; } /* Kanban cards têm borda colorida */
        .pos-homologacao-card { border: 1px solid var(--cor-borda); } /* Cards da nova aba têm borda simples */

        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .card-header h3 { font-size: 16px; margin: 0; }
        .card-header h3 a { color: var(--cor-texto); text-decoration: none; }
        .card-header h3 a:hover { color: var(--cor-primaria); text-decoration: underline; }
        .badge { padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; color: white; }
        .badge.homologacao { background-color: var(--cor-primaria); }
        .badge.reajuste { background-color: var(--cor-aviso); color: #333; }
        .badge.aditivo { background-color: var(--cor-info); }
        .badge.desomologacao { background-color: var(--cor-perigo); }

        .card-body p { font-size: 14px; margin: 5px 0; color: #555; }
        .card-body a { color: var(--cor-primaria); text-decoration: none; font-weight: bold; }
        .card-body a:hover { text-decoration: underline; }

        /* --- CHECKLIST EXPANSÍVEL --- */
        .checklist-container { margin-top: 15px; }
        .checklist-container summary { cursor: pointer; font-weight: bold; color: var(--cor-primaria); font-size: 14px; }
        .checklist { list-style: none; padding: 10px 0 0 5px; margin: 0; }
        .checklist li { font-size: 14px; padding: 8px 0; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #f0f0f0; }
        .task-content { display: flex; align-items: center; }
        .checklist input[type="checkbox"] { margin-right: 10px; flex-shrink: 0; }
        .checklist label.completed { text-decoration: line-through; color: #888; }
        .checklist-date { font-size: 12px; color: #6c757d; font-style: italic; margin-left: 15px; white-space: nowrap; flex-shrink: 0; }
        .card-footer { margin-top: 15px; text-align: right; }
        .btn { padding: 8px 15px; border: none; border-radius: 5px; font-size: 14px; cursor: pointer; color: white; background-color: var(--cor-primaria);}
        .btn-small { padding: 5px 10px; font-size: 12px; } /* Botão menor para ações internas */
        .btn-success { background-color: var(--cor-sucesso); }
        .btn-warning { background-color: var(--cor-aviso); color: #333; }

        /* --- VISÃO DE REAJUSTE --- */
        .reajuste-list { list-style: none; padding: 0; }
        .reajuste-item { display: flex; justify-content: space-between; align-items: center; background: #fff; padding: 20px; border-radius: 6px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .reajuste-info h3 { margin: 0 0 5px 0; font-size: 18px; color: var(--cor-texto); }
        .reajuste-info p { margin: 0; font-size: 14px; color: #555; }
        .reajuste-countdown { text-align: right; }
        .reajuste-countdown .days { font-size: 24px; font-weight: bold; color: var(--cor-primaria); }
        .reajuste-countdown .days.urgent { color: var(--cor-perigo); }
        .reajuste-countdown .label { font-size: 14px; color: #555; }

        /* --- VISÃO PÓS-HOMOLOGAÇÃO --- */
        .pos-homologacao-list { list-style: none; padding: 0; }
        .pos-homologacao-card h3 { font-size: 16px; margin-bottom: 5px; color: var(--cor-texto); }
        .pos-homologacao-card p { font-size: 14px; margin: 5px 0; color: #555; }
        .process-section { border-top: 1px solid var(--cor-borda); margin-top: 15px; padding-top: 15px; }
        .process-section h4 { font-size: 14px; margin: 0 0 10px 0; color: var(--cor-primaria); }
        .process-section .action-area { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
        .process-section input[type="email"], .process-section input[type="number"] { padding: 8px; border: 1px solid var(--cor-borda); border-radius: 4px; font-size: 14px; }
        .mit-note { font-size: 12px; color: #6c757d; margin-top: 5px; }

        /* --- MODAIS --- */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border: 1px solid #888; width: 90%; max-width: 800px; border-radius: 8px; box-shadow: 0 5px 20px rgba(0,0,0,0.3); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--cor-borda); padding-bottom: 15px; margin-bottom: 20px; }
        .modal-header h2 { margin: 0; }
        .close-btn { color: #aaa; font-size: 32px; font-weight: bold; cursor: pointer; }

        /* Formulário do Storytelling */
        .storytelling-form { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label { margin-bottom: 5px; font-weight: bold; font-size: 14px; color: #333; }
        .form-group input, .form-group select, .form-group textarea { padding: 10px; font-size: 16px; border: 1px solid var(--cor-borda); border-radius: 5px; }
        .form-group textarea { min-height: 100px; resize: vertical; }

    </style>
</head>
<body>

    <h1>Central de Contratos de Terceiros</h1>
    
    <div id="notification-bar" class="notification-bar"></div>

    <nav class="main-tabs">
        <button class="tab-btn active" onclick="openTab(event, 'kanban-view')">Kanban de Processos</button>
        <button class="tab-btn" onclick="openTab(event, 'reajuste-view')">Aniversário (Reajuste)</button>
        <button class="tab-btn" onclick="openTab(event, 'pos-homologacao-view')">Pós-Homologação</button>
    </nav>

    <div id="kanban-view" class="tab-content active">
        <div class="controls-container">
            <input type="search" id="search-input" placeholder="Pesquisar por empresa...">
            <select id="filter-status"> <option value="">Filtrar por Status</option> </select>
            <select id="filter-processo"> <option value="">Filtrar por Tipo</option> </select>
        </div>
        <main class="kanban-board" id="kanban-board"></main>
    </div>

    <div id="reajuste-view" class="tab-content">
        <div class="controls-container">
            <input type="search" id="reajuste-search-input" placeholder="Pesquisar por empresa...">
            <select id="reajuste-sort">
                <option value="asc">Classificar por dias (Crescente)</option>
                <option value="desc">Classificar por dias (Decrescente)</option>
            </select>
            <label for="reajuste-period-filter">Filtrar por Mês/Ano:</label>
            <input type="month" id="reajuste-period-filter">
        </div>
        <ul class="reajuste-list" id="reajuste-list"></ul>
    </div>

    <div id="pos-homologacao-view" class="tab-content">
        <div class="controls-container">
            <input type="search" id="pos-homologacao-search" placeholder="Pesquisar por empresa homologada...">
        </div>
        <ul class="pos-homologacao-list" id="pos-homologacao-list">
             </ul>
    </div>

    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Histórico do Processo</h2>
                <span class="close-btn" onclick="closeModal('history-modal')">&times;</span>
            </div>
            <ul id="modal-timeline" class="timeline"></ul>
        </div>
    </div>
    <div id="storytelling-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="storytelling-title">Detalhes do Fornecedor</h2>
                <span class="close-btn" onclick="closeModal('storytelling-modal')">&times;</span>
            </div>
            <form class="storytelling-form">
                <div class="form-group"> <label for="st-fornecedor">FORNECEDOR</label> <input type="text" id="st-fornecedor" readonly> </div>
                <div class="form-group"> <label for="st-codigo">CÓDIGO DO FORNECEDOR (6 dígitos)</label> <input type="number" id="st-codigo"> </div>
                <div class="form-group"> <label for="st-cnpj">CNPJ</label> <input type="text" id="st-cnpj"> </div>
                <div class="form-group"> <label for="st-contato-excecao">NOME DO CONTATO PROPOSTA DE EXCEÇÃO</label> <input type="text" id="st-contato-excecao"> </div>
                <div class="form-group"> <label for="st-email-excecao">E-MAIL PARA ASSINATURA PROPOSTA DE EXCEÇÃO</label> <input type="email" id="st-email-excecao"> </div>
                <div class="form-group"> <label for="st-telefone">CONTATO TELEFONE (11 dígitos)</label> <input type="tel" id="st-telefone"> </div>
                <div class="form-group"> <label for="st-contatos-demanda">CONTATOS PARA RECEBER DEMANDA</label> <input type="text" id="st-contatos-demanda"> </div>
                <div class="form-group"> <label for="st-telefone-demanda">TELEFONE RESPONSÁVEIS DEMANDA (11 dígitos)</label> <input type="tel" id="st-telefone-demanda"> </div>
                <div class="form-group"> <label for="st-receber-demanda">RECEBER DEMANDA?</label> <select id="st-receber-demanda"><option>Sim</option><option>Não</option></select> </div>
                <div class="form-group"> <label for="st-tipo-contrato">TIPO DE CONTRATO</label> <input type="text" id="st-tipo-contrato"> </div>
                <div class="form-group"> <label for="st-estado">ESTADO (UF)</label> <select id="st-estado"></select> </div>
                <div class="form-group"> <label for="st-numero-contrato">NUMERO CONTRATO</label> <input type="text" id="st-numero-contrato"> </div>
                <div class="form-group full-width"> <label for="st-contatos-fechamento">CONTATOS PARA RECEBER COMPOSIÇÃO DE FECHAMENTO</label> <input type="text" id="st-contatos-fechamento"> </div>
                <div class="form-group"> <label for="st-canal">É CANAL?</label> <select id="st-canal"><option>Sim</option><option>Não</option></select> </div>
                <div class="form-group"> <label for="st-selo">ELEGÍVEL AO SELO?</label> <select id="st-selo"><option>Sim</option><option>Não</option></select> </div>
                <div class="form-group"> <label for="st-responsavel-selo">Responsável pelo Selo</label> <input type="text" id="st-responsavel-selo"> </div>
                <div class="form-group"> <label for="st-email-selo">E-mail responsável pelo selo</label> <input type="email" id="st-email-selo"> </div>
                <div class="form-group"> <label for="st-filiais-cxs">CONTRATO COM AS FILIAIS TTS CXS E POA?</label> <select id="st-filiais-cxs"><option>Sim</option><option>Não</option></select> </div>
                <div class="form-group"> <label for="st-filiais-ip">CONTRATO COM AS FILIAIS TTS IP?</label> <select id="st-filiais-ip"><option>Sim</option><option>Não</option></select> </div>
                <div class="form-group full-width"> <label for="st-area-solicitante">ÁREA SOLICITANTE</label> <input type="text" id="st-area-solicitante"> </div>
                <div class="form-group full-width"> <label for="st-obs">OBSERVAÇÃO</label> <textarea id="st-obs"></textarea> </div>
            </form>
        </div>
    </div>


    <script>
    // --- BANCO DE DADOS FALSO (MOCK) ---
    // Adicionei um exemplo de Homologação concluída
    const mockProcessos = [
        {
            id: 101, empresa: "ACME Soluções de TI", processo: "Homologação", tipoContrato: "Consultoria", status: "Concluído", ultimaAtualizacao: "2025-10-14", zendeskTicket: 87345,
            dataHomologacao: "2024-10-20", dataConclusaoHomologacao: "2025-10-14", // Data da conclusão
            storytelling: { codigo: 100201, cnpj: "12.345.678/0001-99", estado: "SP", numeroContrato: "CTR-2024-1020", ehCanal: "Não", elegivelSelo: "Sim" },
            checklists: { "Homologação": [ { tarefa: "Disponibilizar o selo partners para fornecedores SELIND", concluida: true, dataConclusao: "14/10/2025" } ] }, // Simula checklist concluído
            historico: [ { data: "2025-10-14", evento: "Processo de Homologação Concluído." } ]
        },
        {
            id: 102, empresa: "Nexus Inovações", processo: "Reajuste", tipoContrato: "Prestação de Serviços", status: "Em Andamento", ultimaAtualizacao: "2025-10-15", zendeskTicket: 22518,
            dataHomologacao: "2024-12-05",
            storytelling: { codigo: 100315, cnpj: "98.765.432/0001-11", estado: "RJ", numeroContrato: "CTR-2023-0874", ehCanal: "Sim", elegivelSelo: "Sim" },
            checklists: { "Reajuste": [ { tarefa: "Receber solicitação de reajuste", concluida: true, dataConclusao: "12/10/2025" } ] },
            historico: [ { data: "2025-10-15", evento: "Análise do índice contratual concluída." } ]
        },
        {
            id: 103, empresa: "Quantum Tech", processo: "Homologação", tipoContrato: "Consultoria", status: "Aguardando Terceiros", ultimaAtualizacao: "2025-10-10", zendeskTicket: 91023,
            dataHomologacao: "2025-08-01",
            storytelling: { codigo: 100450, cnpj: "55.444.333/0001-22", estado: "MG", numeroContrato: "CTR-2025-1130", ehCanal: "Não", elegivelSelo: "Não" },
            checklists: { "Homologação": [ { tarefa: "Validar documento assim que receber", concluida: false, dataConclusao: null } ] },
            historico: [ { data: "2025-10-10", evento: "Pendências na documentação enviadas ao fornecedor." } ]
        },
        {
            id: 104, empresa: "Orion Soluções", processo: "Aditivo", tipoContrato: "Consultoria", status: "Pendente Análise", ultimaAtualizacao: "2025-10-12", zendeskTicket: 34567,
            dataHomologacao: "2023-01-15",
            storytelling: { codigo: 100500, cnpj: "66.777.888/0001-99", estado: "BA", numeroContrato: "CTR-2023-0050", ehCanal: "Não", elegivelSelo: "Sim" },
            checklists: { "Aditivo": [ { tarefa: "Analisar escopo e cláusulas", concluida: false, dataConclusao: null } ] },
            historico: [ { data: "2025-10-12", evento: "Recebida solicitação de aditivo para incluir novo serviço." } ]
        },
        {
            id: 105, empresa: "LogiSystem", processo: "Desomologação", tipoContrato: "Consultoria", status: "Concluído", ultimaAtualizacao: "2025-09-30", zendeskTicket: 48859,
            dataHomologacao: "2022-05-20",
            storytelling: { codigo: 100112, cnpj: "11.222.333/0001-44", estado: "PR", numeroContrato: "CTR-2022-0412", ehCanal: "Não", elegivelSelo: "Sim" },
            checklists: { "Desomologação": [ { tarefa: "Formalizar distrato", concluida: true, dataConclusao: "30/09/2025" } ]},
            historico: [ { data: "2025-09-30", evento: "Processo de desomologação finalizado." }]
        }
    ];

    // --- LÓGICA GERAL DA PÁGINA ---
    document.addEventListener('DOMContentLoaded', () => {
        populateFilters();
        populateUfSelect();
        renderKanbanView(); // Renderiza a aba inicial
        
        // Listeners Kanban
        document.getElementById('search-input').addEventListener('input', renderKanbanView);
        document.getElementById('filter-status').addEventListener('change', renderKanbanView);
        document.getElementById('filter-processo').addEventListener('change', renderKanbanView);
        
        // Listeners Reajuste
        document.getElementById('reajuste-search-input').addEventListener('input', renderReajusteView);
        document.getElementById('reajuste-sort').addEventListener('change', renderReajusteView);
        document.getElementById('reajuste-period-filter').addEventListener('change', renderReajusteView);

        // Listener Pós-Homologação
        document.getElementById('pos-homologacao-search').addEventListener('input', renderPosHomologacaoView);
    });

    // --- LÓGICA DAS ABAS ---
    function openTab(evt, tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        evt.currentTarget.classList.add('active');

        // Renderiza o conteúdo da aba clicada
        if (tabName === 'kanban-view') {
            renderKanbanView();
        } else if (tabName === 'reajuste-view') {
            renderReajusteView();
        } else if (tabName === 'pos-homologacao-view') {
            renderPosHomologacaoView();
        }
    }
    
    // --- LÓGICA DA NOTIFICAÇÃO ---
    function updateNotification() {
        const notificationBar = document.getElementById('notification-bar');
        const pendingCount = mockProcessos.filter(p => p.status === 'Pendente Análise').length;
        
        if (pendingCount > 0) {
            notificationBar.innerHTML = `🔔 Você tem ${pendingCount} ${pendingCount > 1 ? 'pendências' : 'pendência'} na coluna <a onclick="focusPending()">"Pendente Análise"</a>.`;
            notificationBar.style.display = 'block';
        } else {
            notificationBar.style.display = 'none';
        }
    }
    function focusPending() { /* ... código idêntico ... */ }

    // --- LÓGICA DO KANBAN ---
    const colunas = { /* ... código idêntico ... */ };
    function populateFilters() { /* ... código idêntico ... */ }
    function renderKanbanView() {
        updateNotification();
        const board = document.getElementById('kanban-board'); board.innerHTML = '';
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        const statusFilter = document.getElementById('filter-status').value;
        const processoFilter = document.getElementById('filter-processo').value;
        const filteredProcessos = mockProcessos.filter(p => {
            const matchesSearch = p.empresa.toLowerCase().includes(searchTerm);
            const matchesStatus = !statusFilter || p.status === statusFilter;
            const matchesProcesso = !processoFilter || p.processo === processoFilter;
            return matchesSearch && matchesStatus && matchesProcesso;
        });
        for (const status in colunas) { const colunaInfo = colunas[status]; const count = filteredProcessos.filter(p => p.status === status).length; board.innerHTML += `<div class="kanban-column" id="${colunaInfo.id}"><h2 >${colunaInfo.titulo} <span class="task-count">${count}</span></h2></div>`; }
        filteredProcessos.forEach(processo => { const colunaEl = document.getElementById(colunas[processo.status].id); if (colunaEl) colunaEl.innerHTML += createCardHtml(processo); });
        addChecklistListeners();
    }
    function createCardHtml(processo) { /* ... código idêntico ... */ }

    // --- LÓGICA DA ABA DE REAJUSTE ---
    function renderReajusteView() { /* ... código idêntico ... */ }

    // --- NOVO: LÓGICA DA ABA PÓS-HOMOLOGAÇÃO ---
    function renderPosHomologacaoView() {
        const listEl = document.getElementById('pos-homologacao-list');
        listEl.innerHTML = '';
        const searchTerm = document.getElementById('pos-homologacao-search').value.toLowerCase();

        const concluidos = mockProcessos.filter(p =>
            p.processo === "Homologação" &&
            p.status === "Concluído" &&
            p.empresa.toLowerCase().includes(searchTerm)
        );

        if (concluidos.length === 0) {
            listEl.innerHTML = '<p style="text-align:center; color: #555;">Nenhum processo de homologação concluído encontrado.</p>';
            return;
        }

        concluidos.forEach(p => {
            listEl.innerHTML += createPosHomologacaoCardHtml(p);
        });
    }

    function createPosHomologacaoCardHtml(processo) {
        const isCanal = processo.storytelling?.ehCanal === "Sim";
        const dataConclusao = processo.dataConclusaoHomologacao ? new Date(processo.dataConclusaoHomologacao + 'T12:00:00Z') : null;
        const hoje = new Date();
        const diffTime = dataConclusao ? hoje - dataConclusao : null;
        const diffDays = diffTime ? Math.floor(diffTime / (1000 * 60 * 60 * 24)) : null;
        const mitEligible = diffDays !== null && diffDays >= 30;

        return `
            <li class="pos-homologacao-card card-base">
                <h3>${processo.empresa}</h3>
                <p><strong>Homologado em:</strong> ${dataConclusao ? dataConclusao.toLocaleDateString('pt-BR') : 'Data não registrada'}</p>
                <p><strong>Zendesk (Homologação):</strong> <a href="#" target="_blank">Ticket #${processo.zendeskTicket}</a></p>

                <div class="process-section">
                    <h4>1. Formulário Pós-Homologação</h4>
                    <div class="action-area">
                        <button class="btn btn-small" onclick="alert('Simulando envio do formulário para ${processo.empresa}')">Enviar Formulário</button>
                        <input type="number" placeholder="Nº Ticket Zendesk (5 dígitos)" min="10000" max="99999" style="width: 200px;">
                        <button class="btn btn-small btn-success" onclick="alert('Ticket registrado!')">Registrar Ticket</button>
                    </div>
                </div>

                <div class="process-section">
                    <h4>2. Selo Partners</h4>
                    ${isCanal ? '<p style="color:var(--cor-sucesso); font-weight:bold;">✅ Fornecedor é Canal.</p>' : '<p style="color:var(--cor-perigo);">❌ Fornecedor NÃO é Canal (Selo não aplicável).</p>'}
                    <div class="action-area">
                        <input type="email" placeholder="E-mail do Responsável pelo Selo" style="flex-grow: 1;" ${!isCanal ? 'disabled' : ''}>
                        <input type="number" placeholder="Nº Ticket Zendesk" min="10000" max="99999" style="width: 150px;" ${!isCanal ? 'disabled' : ''}>
                        <button class="btn btn-small btn-success" onclick="alert('Registro do envio do selo simulado!')" ${!isCanal ? 'disabled' : ''}>Registrar Envio do Selo</button>
                    </div>
                </div>

                <div class="process-section">
                    <h4>3. Liberação MIT</h4>
                     <p class="mit-note"> ${diffDays !== null ? `Dias desde a conclusão: ${diffDays}.` : ''} ${mitEligible ? '<strong style="color:var(--cor-sucesso);"> Elegível para MIT.</strong>' : '<strong style="color:var(--cor-aviso);"> Aguardando 30 dias.</strong>'} </p>
                    <div class="action-area">
                         <button class="btn btn-small btn-warning" onclick="alert('Simulando envio de e-mail para Universidade (MIT)')" ${!mitEligible ? 'disabled' : ''}>Enviar E-mail Universidade</button>
                         <button class="btn btn-small btn-success" onclick="alert('Simulando envio de e-mail para Fornecedor (MIT)')" ${!mitEligible ? 'disabled' : ''}>Enviar E-mail Fornecedor</button>
                    </div>
                </div>
            </li>
        `;
    }


    // --- LÓGICA DOS MODAIS E INTERATIVIDADE ---
    // ... (As funções openHistoryModal, openStorytellingModal, closeModal, etc. continuam idênticas) ...
    function openHistoryModal(processoId) { /* ...código idêntico... */ }
    function openStorytellingModal(processoId) { /* ...código idêntico... */ }
    function closeModal(modalId) { /* ...código idêntico... */ }
    function addChecklistListeners() { /* ...código idêntico... */ }
    function populateUfSelect() { /* ...código idêntico... */ }
    window.onclick = function(event) { if (event.target.classList.contains('modal')) { event.target.style.display = "none"; } }
    </script>

</body>
</html>
